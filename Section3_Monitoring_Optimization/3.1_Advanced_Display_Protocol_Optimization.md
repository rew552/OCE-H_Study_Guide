# 3.1 Advanced Display Protocol Optimization（表示プロトコルの高度な最適化）

> **試験ガイド対応**: Section 4.3.1 - Advanced optimization of display protocols

---

## Objective 1: Configure Max Session Bandwidth registry to limit data usage（Max Session Bandwidth レジストリによるデータ使用量の制限）

### Horizon Blast Max Session Bandwidth の概要

Blast セッションの最大帯域幅を制限することで、ネットワーク帯域幅を効率的に管理し、マルチユーザー環境でのリソース競合を防止する。この設定はイメージング、オーディオ、仮想チャネル、USB、制御トラフィックを含むすべてのBlastトラフィックに適用される。

### GPO による設定

**ADMX テンプレート**: `hzn_blast.admx`（Horizon GPO Bundle に含まれる）

**GPO パス**:

```
Computer Configuration > Policies > Administrative Templates > Omnissa Horizon Blast
```

| GPO 設定名 | 説明 |
|---|---|
| **Max Session Bandwidth** | セッションあたりの最大帯域幅（kbps）。デフォルト: 1 Gbps |
| **Min Session Bandwidth** | セッションあたりの最小予約帯域幅（kbps）。デフォルト: 256 kbps |
| **Max Session Bandwidth kbit/s Megapixel Slope** | メガピクセルあたりの帯域幅スロープ（kbps）。デフォルト: 6200 |

### レジストリによる直接設定

**レジストリパス（GPO 適用時）**:

```
HKLM\Software\Policies\Omnissa\Horizon\Blast\Config
```

**レジストリパス（ローカル設定時）**:

```
HKLM\Software\Omnissa\Horizon\Blast\Config
```

| レジストリ値 | 型 | デフォルト値 | 説明 |
|---|---|---|---|
| `MaxSessionBandwidth` | REG_SZ | 1000000 (≒1Gbps) | セッション最大帯域幅（kbps） |
| `MinSessionBandwidth` | REG_SZ | 256 | セッション最小予約帯域幅（kbps） |
| `MaxBandwidthKbpsPerMegaPixelSlope` | REG_SZ | 6200 | メガピクセルあたりの帯域幅スロープ |
| `EncoderMaxFPS` | REG_SZ | 30 | 最大フレームレート（fps） |

### 用途別推奨帯域幅設定

| ユースケース | Max Session Bandwidth (kbps) | Min Session Bandwidth (kbps) | Max Frame Rate |
|---|---|---|---|
| タスクワーカー（Office、Web閲覧） | 5,000 - 10,000 | 256 | 15-30 |
| ナレッジワーカー（マルチモニタ） | 10,000 - 20,000 | 512 | 30 |
| マルチメディア（動画再生） | 20,000 - 40,000 | 1,024 | 30 |
| パワーユーザー（CAD/3D） | 40,000 - 100,000 | 2,048 | 30-60 |
| GPU ワークロード（120fps対応） | 100,000+ | 4,096 | 60-120 |

### 帯域幅制限の動作原理

- **Max Session Bandwidth** はエージェント・クライアント双方で設定可能。両方に設定がある場合、低い方の値が使用される
- **Min Session Bandwidth** は設定したエンドポイント側にのみ適用される。セッション応答性の向上のため、最小帯域幅を予約する
- すべてのエンドポイントの Min Session Bandwidth の合計がネットワーク容量を超えないよう設計する必要がある
- 設定変更はアクティブセッション中でも即座に反映される

> **試験ポイント**: Max Session Bandwidth はエージェントとクライアントの低い方の値が採用される。Min Session Bandwidth は設定したエンドポイント側にのみ適用される。

---

## Objective 2: Build-to-lossless の使用すべき/すべきでないシナリオの判断基準

### Build-to-lossless の仕組み

Build-to-lossless（プログレッシブビルド）は、初期圧縮画像（lossy）から段階的にロスレス（完全忠実）状態へビルドアップするエンコーディング手法。画面変更があるとまず高圧縮の lossy イメージを即座に表示し、変更のない領域を徐々にロスレス品質まで引き上げる。

### Blast における Build-to-lossless

**GPO 設定**: `Build to Lossless`（hzn_blast.admx）

**レジストリ**:

```
HKLM\SOFTWARE\Omnissa\Horizon\Blast\Config
  EncoderBuildToLossless = 1 (REG_SZ)   ← 有効化
  EncoderBuildToLossless = 0 (REG_SZ)   ← 無効化（デフォルト）
```

**動作**: 有効化すると GPU エンコーディングアクセラレーションが無効になり、CPU エンコーディングに切り替わる。CPU 使用率とネットワーク帯域幅の消費が増加する。

### Lossless 圧縮モードとの違い

Build-to-lossless と混同しやすい「Lossless Compression」は別の設定である。

| 機能 | Build-to-lossless | Lossless Compression |
|---|---|---|
| **動作** | lossy → 段階的にロスレスへビルドアップ | 常時ロスレスで送信 |
| **初期表示** | 即座（lossy 品質） | 遅い（ロスレス品質） |
| **帯域幅消費** | 中〜高（ビルドアップ時） | 非常に高（常時） |
| **GPU エンコード** | 無効化される | 無効化される |
| **用途** | 静止画の精密表示が必要な場面 | 常にピクセル完全忠実が必要な場面 |

### PCoIP における Build-to-lossless

**GPO 設定**: `Turn off Build-to-Lossless feature`（pcoip.admx）

**GPO パス**:

```
Computer Configuration > Policies > Administrative Templates
  > PCoIP Session Variables > Overridable Administrator Defaults
```

**動作**: デフォルトで **オフ**（GPO 設定が「有効」= Build-to-lossless がオフ）。GPO 設定を「無効」にすると Build-to-lossless がオンになる。

| GPO の状態 | Build-to-lossless の動作 |
|---|---|
| 有効（Enabled）or 未構成 | Build-to-lossless **オフ** |
| 無効（Disabled） | Build-to-lossless **オン** |

### 使用すべきシナリオ

| シナリオ | 根拠 |
|---|---|
| **医療画像（DICOM ビューア）** | 診断精度のためピクセル単位の忠実度が必須 |
| **CAD/CAM アプリケーション** | 寸法・線の正確な表示が設計品質に直結 |
| **GIS（地理情報システム）** | 地図データの細部まで正確に表示する必要がある |
| **グラフィックデザイン（DTP/写真編集）** | 色再現性とピクセル精度が成果物の品質を左右 |
| **LAN 環境で十分な帯域幅がある場合** | 帯域幅の増加を吸収できる |
| **静的コンテンツが多いワークロード** | 画面変更が少ないため帯域幅消費が限定的 |

### 使用すべきでないシナリオ

| シナリオ | 根拠 |
|---|---|
| **低帯域幅の WAN 環境** | ロスレスビルドアップに帯域幅を消費し、全体のUXが低下 |
| **モバイル・衛星接続** | 帯域幅制約が厳しく、プログレッシブビルドが完了しない |
| **動画再生・ストリーミング中心のワークロード** | 画面が常に変化するためロスレスまでビルドされない |
| **高密度RDSHセッション** | CPU 使用率の増加が他のセッションに悪影響 |
| **基本的なオフィス作業（テキスト編集、メール）** | ロスレスの恩恵が少なく、リソースの無駄 |
| **GPU アクセラレーションが必要な環境** | Build-to-lossless は GPU エンコードを無効化する |

> **試験ポイント**: Build-to-lossless は「ピクセル精度が要求される + 十分な帯域幅がある」場合にのみ使用する。GPU エンコードが無効になる点を理解しておくこと。Blast のロスレス圧縮に焦点を当て、Build-to-lossless が Blast/PCoIP 双方で利用可能だが設定方法が異なる点に注意。

---

## Blast Extreme コーデック比較

### コーデック一覧と特性

| 特性 | BlastCodec | H.264 | HEVC (H.265) | AV1 |
|---|---|---|---|---|
| **開発元** | Omnissa 独自 | 標準規格 | 標準規格 | AOM（オープン） |
| **CPU エンコード** | ○（マルチスレッド対応） | ○ | × | × |
| **GPU エンコード** | × | ○（NVIDIA/AMD/Intel） | ○（NVIDIA/AMD/Intel） | ○（一部GPU） |
| **帯域幅効率** | 中 | 中 | 高 | 最高 |
| **テキスト品質** | 最高（ロスレステキスト） | 良好 | 良好 | 良好 |
| **低帯域幅適性** | ○ | ○ | ◎ | ◎ |
| **High Color Accuracy (4:4:4)** | N/A | ○（GPU必須） | ○（GPU必須） | × |
| **デフォルト** | ○（GPU なし時） | ○（GPU あり時） | 明示的に有効化が必要 | 明示的に有効化が必要 |
| **主な用途** | 汎用、テキスト多用 | GPU搭載環境の汎用 | 高圧縮が必要な WAN | 次世代圧縮 |

### コーデック選択のロジック

Blast はクライアントとエージェントの両方が対応するコーデックをネゴシエーションし、最適なコーデックを自動選択する。

1. クライアント側で指定されたコーデック（Horizon Client の設定）
2. エージェント側のレジストリ/GPO 設定で有効化されたコーデック
3. GPU が利用可能な場合: H.264 > HEVC > AV1（有効化されている場合）
4. GPU が利用不可の場合: BlastCodec（CPU エンコード）

**Adaptive コーデック設定**: クライアント側で「Adaptive」を選択すると、画面コンテンツの種類に応じてコーデックを動的に切り替える。テキスト領域には BlastCodec、動画領域には H.264/HEVC を使用する。

### コーデック関連レジストリ設定

**レジストリパス**: `HKLM\Software\Omnissa\Horizon\Blast\Config`

| レジストリ値 | 型 | デフォルト | 説明 |
|---|---|---|---|
| `EncoderH264Enabled` | REG_SZ | 1 | H.264 エンコーディングの有効/無効 |
| `EncoderHEVCEnabled` | REG_SZ | 0 | HEVC (H.265) エンコーディングの有効/無効 |
| `EncoderAV1Enabled` | REG_SZ | 0 | AV1 エンコーディングの有効/無効 |
| `H264maxQP` | REG_SZ | 36 | H.264 最大量子化パラメータ（0-51） |
| `H264minQP` | REG_SZ | 10 | H.264 最小量子化パラメータ（0-51） |
| `BlastCodecEnableMultiSlice` | REG_SZ | 1 | BlastCodec マルチスレッドエンコーディング |
| `EncoderGlobalQualityLevel` | REG_SZ | 1 | 全コーデック共通の品質レベル（1-5） |

> **試験ポイント**: HEVC と AV1 はデフォルトで無効。明示的にレジストリで有効化が必要。AV1 は HEVC より高い圧縮効率を持つが、対応 GPU が限定される。

### H.264 High Color Accuracy

H.264 使用時にカラースペースを変更して色精度を向上させる設定。GPU ハードウェアアクセラレーションが必要。

| カラースペース | 色精度 | 帯域幅消費 | 用途 |
|---|---|---|---|
| YUV 4:2:0（デフォルト） | 標準 | 低 | 一般的なデスクトップ |
| YUV 4:2:2 | 高 | 中 | カラー重視のワークロード |
| YUV 4:4:4 | 最高 | 高 | グラフィックデザイン、医療画像 |

> **補足**: HEVC/H.265 も H.264 と同様に YUV 4:4:4 をサポート（GPU 必須）。AV1 は現時点で High Color Accuracy 設定をサポートしない。

### Blast Optimizer

単一の設定でユーザーエクスペリエンスとリソース効率のバランスを制御する。

| 値 | 動作 |
|---|---|
| 1-4 | リソース効率優先（encoderGlobalQualityLevel, bandwidth slope, maxFPS を低く） |
| **5（デフォルト）** | Blast デフォルト設定を使用 |
| 6-10 | ユーザーエクスペリエンス優先（encoderGlobalQualityLevel, bandwidth slope, maxFPS を高く） |

### Encoder CPU Controller

システム CPU 使用率に応じて最大 FPS を動的に調整し、マルチセッション環境での CPU 負荷を制御する。

| レジストリ値 | デフォルト | 説明 |
|---|---|---|
| `EncoderCPUControllerEnabled` | 1（有効） | CPU コントローラーの有効/無効 |
| `EncoderMinCPUThrottleFPS` | 5 | CPU スロットリング時の最低 FPS |

---

## Blast Extreme ログファイルの場所

Horizon Agent 側の Blast 関連ログは `<Drive>:\ProgramData\` 配下のサブディレクトリに保存される。

| ログファイル | 内容 |
|---|---|
| `Blast-Service.log` | Blast サービス（VMBlastS.exe）のログ。セッション管理、TCP プロキシ |
| `Blast-Worker-SessionId<#>.txt` | Blast ワーカープロセス（VMBlastW.exe）のログ。画面キャプチャ、セッション処理 |
| `Blast-Proxy.log` | Blast プロキシのログ |

**クライアント側**:
- **Windows**: Horizon Client のログ収集機能を使用
- **Mac**: Horizon Client のログ収集機能を使用

---

## Media Optimization for Microsoft Teams（Teams メディア最適化）

### 概要

通常の仮想デスクトップでのビデオ通話は、マイク・カメラのデータが仮想デスクトップに送信され、RTAV（Real-Time Audio-Video）で処理される。Media Optimization for Microsoft Teams は、通話メディアをクライアント端末で直接処理し、仮想デスクトップを経由しない最適化を実現する。

### 動作原理

1. ユーザーが仮想デスクトップ内で Teams 通話を開始
2. Horizon Client がクライアント端末でローカルに通話チャネルを確立
3. メディア（音声・映像）はクライアント端末と通話先の間で直接送受信
4. Horizon Client は Teams ウィンドウ上にオーバーレイ描画し、仮想デスクトップ内で操作している印象を維持
5. RTAV を使用しないため、ネットワーク負荷とデータセンターの処理負荷が大幅に軽減

### 要件とサポート

| 項目 | 要件 |
|---|---|
| **Horizon Agent** | 8.4 (2111) 以降。8.8 (2212) 以降はデフォルト有効 |
| **Horizon Client** | Windows / Mac / Linux / Chrome: 8.4 (2111) 以降 |
| **クライアント CPU** | 2.4 GHz 以上のデュアルコア推奨 |
| **デスクトップ vCPU** | 2 vCPU 以上 |
| **Teams クライアント** | 新しい Teams（teamsbootstrapper.exe で VDI 向けインストール） |

### レジストリ設定

Horizon Agent インストール時に自動作成される:

```
HKLM\SOFTWARE\Policies\Omnissa\Horizon\WebRTCRedir
  teamsEnabled = 1 (REG_DWORD)   ← Media Optimization 有効
```

**GPO 設定**: `Force client side WebRTC optimization`

- 有効: エンドポイントで Teams Media Optimization を強制（クライアント設定を上書き）
- 未構成/無効: クライアント側で「Media Optimization for WebRTC based applications」設定を制御可能

### 動作モード

| モード | 表示テキスト | 説明 |
|---|---|---|
| **Optimized** | "Horizon Media Optimized" | メディアがクライアント端末にオフロードされ最適化済み |
| **Fallback** | "Horizon Media Not Connected" | 最適化が有効だがクライアントが非対応。RTAV が使用される |
| **Non-optimized** | （Horizon テキストなし） | 最適化が無効。RTAV が使用される |

### 非パーシステント環境での Teams インストール

```
.\teamsbootstrapper.exe -p -o "c:\path\MSTeams-x64.msix" --installTMA
```

**自動更新の無効化**（非パーシステント環境で推奨）:

```
HKLM\SOFTWARE\Microsoft\Teams
  disableAutoUpdate = 1 (REG_DWORD)
```

### Windows Server (RDSH) での追加要件

- Microsoft Edge WebView2 のインストール（最低バージョン 90.0.818.66）
- ストアアプリのサイドローディング有効化（GPO: `Allow all trusted apps to install`）
- DISM によるインストール: `Dism /Online /Add-ProvisionedAppxPackage /PackagePath:"MSTeams-x64.msix" /SkipLicense`
- Horizon Agent 2312.1 以降でストアアプリの公開をサポート
- UWP サポート GPO の有効化: `Enable UWP support on RDSH platforms`

### Teams SlimCore 最適化（次世代）

Microsoft は従来の WebRTC ベースの最適化に代わる SlimCore ベースの新しい VDI 最適化を開発中。

| 項目 | 詳細 |
|---|---|
| **改善点** | 通話セットアップ時間の短縮、品質・パフォーマンス向上、新しいコーデック対応 |
| **新機能** | カスタム背景、HID ヘッドセットサポート、ノイズ抑制、大きなギャラリービュー |
| **GA 予定** | 2026年3月（Windows エンドポイント向け） |
| **開発主体** | Microsoft |

### トラブルシューティングのポイント

| 問題 | 確認事項 |
|---|---|
| Teams が Fallback モード | `teamsEnabled` レジストリキーが 1 であること。Citrix Agent が共存していないこと |
| 最適化されない | `hosts` ファイルに `127.0.0.1 view-localhost` が存在すること |
| html5Server 未起動 | タスクマネージャで `html5Server.exe` を確認。VM 再起動 |
| プロキシ環境 | プロキシバイパスリストに `view-localhost` を追加。PAC ファイルで `wss://` を許可 |

> **試験ポイント**: Media Optimization は RTAV を使用せず、メディアをクライアント端末で直接処理する。Horizon Agent 2212 以降はデフォルトで有効。Citrix Agent が共存すると最適化が機能しない（Microsoft の制約）。

---

## UDP vs TCP の使い分け（Adaptive Transport）

### トランスポートプロトコルの特性

| 特性 | TCP | UDP (BEAT) |
|---|---|---|
| **信頼性** | 保証あり（再送制御） | アプリケーション層で制御 |
| **レイテンシ** | 高い（輻輳時にバックオフ） | 低い（パケット損失時に適応的に処理） |
| **パケットロス耐性** | 低い（再送によるレイテンシ増大） | 高い（FEC による前方誤り訂正） |
| **WAN 適性** | 安定だが高レイテンシ | 低レイテンシで高速応答 |
| **デフォルト** | Horizon Web Client のみ | Windows/Mac/Linux/Mobile Client |
| **ポート** | TCP 8443 (UAG) / TCP 22443 (Agent) | UDP 8443 (UAG) / UDP 22443 (Agent) |

### Adaptive Transport (BEAT) の設定

**Blast Extreme Adaptive Transport (BEAT)** は Horizon Blast の UDP ベースのトランスポートプロトコルで、ネットワーク状況に応じて自動的に TCP から UDP へフォールバック/フォールフォワードする。

**GPO 設定**: `UDP Protocol`（hzn_blast.admx）

**レジストリ**: `HKLM\Software\Omnissa\Horizon\Blast\Config`

| レジストリ値 | デフォルト | 説明 |
|---|---|---|
| `UDPEnabled` | 1 | UDP プロトコルの有効化（1=有効, 0=TCP のみ） |

### BEAT の推奨設定

- UDP はデフォルトで有効であり、ほとんどの環境で推奨される
- TCP は UDP に対応しないネットワーク（ファイアウォール制限、プロキシ環境）、または非常に高いレイテンシ（250ms 超）の WAN 回線でのみ推奨
- BEAT は自動的にネットワーク状態を検出し、UDP が利用できない場合は TCP にフォールバックする

### トランスポート選択の判断基準

| 条件 | 推奨トランスポート |
|---|---|
| LAN 環境（低レイテンシ・低パケットロス） | TCP / UDP どちらでも良好 |
| WAN 環境（高レイテンシ） | UDP (BEAT) を推奨 |
| 高パケットロス環境（>1%） | UDP (BEAT) を推奨（FEC 機能あり） |
| ファイアウォールが UDP をブロック | TCP にフォールバック |
| Horizon Web Client (HTML Access) | TCP のみ（UDP 非対応） |
| プロキシ経由の接続 | TCP（プロキシは通常 UDP 非対応） |
| 非常に高いレイテンシ（250ms超） | TCP が安定する場合がある |

### UAG での Blast TCP/UDP ポート構成

| 接続タイプ | デフォルトポート | ポート共有 |
|---|---|---|
| 外部接続（UAG 経由） | TCP 8443 / UDP 8443 | TCP 443 でポート共有可能 |
| 内部接続（直接） | TCP 22443 / UDP 22443 | - |
| トンネル接続（CS 経由） | TCP 8443 / UDP 8443 | - |

---

## DSCP マーキング（QoS）

Blast トラフィックに DSCP 値を設定して、ネットワークデバイスでの QoS 優先制御を有効にする。

**GPO 設定**: `DSCP Marking`（hzn_blast.admx）

設定可能な接続方向:
- Agent → Client (TCP/UDP, IPv4/IPv6)
- BSG → Client (TCP/UDP, IPv4/IPv6)
- BSG → Agent (TCP/UDP, IPv4/IPv6)
- Client → Agent (TCP/UDP, IPv4/IPv6)

各接続に対して 0-63 の DSCP 値を設定可能。

---

## セキュリティ機能

| 機能 | 説明 |
|---|---|
| **AES 暗号化** | デフォルト AES-128。AES-256 に変更可能 |
| **TLS** | すべての TCP/UDP 接続で TLS を使用 |
| **SHA-256** | 最新のセキュリティアルゴリズムを使用 |
| **Dual IPv4/IPv6** | UAG で IPv6 クライアントと IPv4 バックエンドのブリッジが可能。ポート共有時は TCP 443 のみ |
| **FIPS** | UAG に FIPS 対応ライブラリを搭載 |
| **Common Criteria** | Horizon 8.7 (2209) 以降で NIAP 認証取得済み |
| **ポート共有** | UAG で TCP 443 のポート共有により追加ポート不要 |

---

## ベストプラクティス

1. **帯域幅設計**: Max Session Bandwidth は実際のリンク容量の 90% 程度に設定し、他のトラフィック用に 10% のマージンを確保する
2. **マルチセッション環境**: RDS ホストでは同時セッション数を考慮して Max Session Bandwidth を計算する
3. **WAN 環境**: UDP (BEAT) を有効にし、Encoder CPU Controller を活用してセッション品質を自動調整する
4. **GPU 環境**: H.264 または HEVC をエンコーダとして使用し、High Color Accuracy が必要なら YUV 4:4:4 を有効化する
5. **Build-to-lossless**: GPU エンコードが無効になることを考慮し、医療画像・CAD など必要な場合にのみ有効にする
6. **テスト**: 本番環境適用前に、対象ユースケースで帯域幅消費・CPU 使用率・ユーザーエクスペリエンスを検証する
7. **Teams 最適化**: 非パーシステント環境では Teams の自動更新を無効化し、ゴールデンイメージでバージョンを管理する

## アンチパターン

1. **過度な帯域幅制限**: Max Session Bandwidth を低く設定しすぎると、画質・応答性が著しく低下する
2. **全環境で Build-to-lossless 有効化**: GPU エンコードの無効化と CPU 負荷増大により、密度と性能が低下する
3. **Min Session Bandwidth の過剰予約**: 全セッションの合計がリンク容量を超えるとネットワーク全体に悪影響
4. **UDP 未対応環境で UDP を強制**: ファイアウォールやプロキシで UDP がブロックされている場合、接続失敗する
5. **コーデック設定の未検証**: 環境に合わないコーデック設定はパフォーマンス低下を招く
6. **Teams 最適化と Citrix Agent の共存**: Citrix Agent がインストールされていると Teams Media Optimization が機能しない

---

## 理解度チェックリスト

### Max Session Bandwidth
- [ ] Max Session Bandwidth のレジストリパスと GPO 設定名を説明できる
- [ ] エージェントとクライアント双方に設定がある場合、どちらの値が採用されるか理解している
- [ ] Min Session Bandwidth の予約帯域幅が設定側のエンドポイントのみに適用されることを理解している
- [ ] 用途に応じた推奨帯域幅値を判断できる

### Build-to-lossless
- [ ] Build-to-lossless のプログレッシブビルドの仕組みを説明できる
- [ ] Blast と PCoIP それぞれの Build-to-lossless GPO 設定の違い（有効/無効の意味）を理解している
- [ ] 使用すべきシナリオと使用すべきでないシナリオを明確に判断できる
- [ ] Build-to-lossless 有効化時に GPU エンコードが無効になることを認識している
- [ ] Build-to-lossless と Lossless Compression の違いを説明できる

### コーデックとトランスポート
- [ ] BlastCodec、H.264、HEVC、AV1 の各コーデックの特性と適用場面を比較できる
- [ ] UDP (BEAT) と TCP の使い分け基準を説明できる
- [ ] Adaptive Transport の動作原理（自動フォールバック/フォールフォワード）を理解している
- [ ] Encoder CPU Controller の目的とレジストリ設定を把握している
- [ ] コーデック選択のロジック（Adaptive 設定含む）を説明できる

### Teams 最適化
- [ ] Media Optimization for Microsoft Teams の動作原理（RTAV を使用しない直接メディア処理）を説明できる
- [ ] Teams の Optimized / Fallback / Non-optimized モードの違いを区別できる
- [ ] `teamsEnabled` レジストリキーの場所と値を把握している
- [ ] 非パーシステント環境での Teams インストールと自動更新無効化の手順を理解している
