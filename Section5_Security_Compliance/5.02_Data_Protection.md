# 5.2 Data Protection — Clipboard / CDR / USB Redirection

## Objective 4.5.2: Data Protection - Clipboard restrictions, Drive redirection policies

Clipboard 制御、Client Drive Redirection (CDR)、USB Redirection の設定場所・オプション・ポリシー適用方法について扱う。

---

## Clipboard / CDR ポリシーの設定場所とオプション

### ポリシー制御の 3 レベルと優先順位

Horizon 環境では Clipboard / CDR ポリシーを **3 つのレベル** で制御でき、以下の優先順位で評価される。

```
Agent GPO（最高優先）  >  DEM Smart Policy  >  CS Global Policy（最低優先）
```

| レベル | 設定場所 | 適用粒度 | 特徴 |
|---|---|---|---|
| **Agent GPO** | Group Policy → `Computer Configuration` → `Administrative Templates` → `Omnissa Horizon Agent Configuration` | OU / コンピュータ単位 | 最も優先度が高い。ADMX テンプレートで設定 |
| **DEM Smart Policy** | DEM Management Console → Horizon Smart Policies | ユーザー / 条件ベース | 接続元（内部/外部）、クライアント IP 等の条件で動的にポリシーを適用可能 |
| **CS Global Policy** | Horizon Console → **Policies** → **Global Policies** | 環境全体 | デフォルトのベースラインポリシー。他レベルで上書き可能 |

> **試験ポイント**: Agent GPO が最も優先度が高く、CS Global Policy のみでは Agent GPO で許可された設定を制限できない。セキュリティ要件が厳しい場合は Agent GPO レベルで制限する。

### Clipboard Redirection の設定

#### Horizon Console（CS Global Policy）

**設定パス**: Horizon Console → **Policies** → **Global Policies**

| ポリシー設定 | 説明 |
|---|---|
| **Allow** | Clipboard リダイレクション有効（双方向） |
| **Deny** | Clipboard リダイレクション無効 |

#### Agent GPO での設定

**ADMX テンプレート**: `vdm_agent.admx`（Horizon Agent Configuration）

**設定パス**: `Computer Configuration` → `Policies` → `Administrative Templates` → `Omnissa Horizon Agent Configuration` → `Clipboard Redirection`

| GPO 設定項目 | 説明 |
|---|---|
| **Configure clipboard redirection** | Clipboard リダイレクションの方向を制御 |
| — Disabled in both directions | 双方向で無効 |
| — Enabled client to server only | クライアント → サーバのみ許可 |
| — Enabled server to client only | サーバ → クライアントのみ許可 |
| — Enabled in both directions | 双方向で有効（デフォルト） |
| **Configure clipboard redirection formats** | 許可するクリップボード形式（テキスト、リッチテキスト、画像、ファイル等）を制御 |
| **Configure clipboard audit** | Clipboard 操作の監査ログを有効化 |
| **Whether block clipboard redirection to client side when client doesn't support audit** | 監査非対応クライアントへの Clipboard リダイレクションをブロック |
| **Clipboard memory size on server** | サーバ側の Clipboard バッファサイズ（デフォルト: 1 MB） |

> **試験ポイント**: Clipboard の **方向制御** は Agent GPO でのみ細かく設定可能。CS Global Policy では Allow / Deny の 2 択のみ。

#### Clipboard 形式のフィルタリング

Agent GPO の **Configure clipboard redirection formats** で、以下のデータ形式ごとにコピー＆ペーストの許可/拒否を個別に設定可能:

| フォーマット | 説明 |
|---|---|
| **Text** | プレーンテキスト |
| **Rich Text (RTF)** | リッチテキスト形式 |
| **Images (BMP/TIFF)** | 画像データ |
| **HTML Format** | HTML コンテンツ |
| **FileContents / FileGroupDescriptor** | ファイルのコピー＆ペースト |

### Client Drive Redirection (CDR) の設定

CDR はクライアントデバイスのローカルドライブ（HDD、USB ストレージ等）をリモートデスクトップにマップする機能。

#### Horizon Console（CS Global Policy）

**設定パス**: Horizon Console → **Policies** → **Global Policies**

| ポリシー設定 | 説明 |
|---|---|
| **Allow** | CDR 有効 |
| **Deny** | CDR 無効 |

#### Agent GPO での CDR 設定

**ADMX テンプレート**: `vdm_agent.admx`

**設定パス**: `Computer Configuration` → `Policies` → `Administrative Templates` → `Omnissa Horizon Agent Configuration` → `Client Drive Redirection`

| GPO 設定項目 | 説明 |
|---|---|
| **Deactivate client drive redirection** | CDR の完全無効化 |
| **Configure drive letter behavior** | ドライブレター割り当ての動作制御 |
| **Read only access** | 読み取り専用マウント（書き込み不可） |

**ドライブレター動作の制御**:

| オプション | 動作 |
|---|---|
| **Use client-specified drive letter** | クライアント指定のドライブレターを使用 |
| **Start with a specified letter** | 指定した開始文字から順に割り当て |

#### UAG 環境での CDR

UAG 経由でも CDR は利用可能。Blast Extreme プロトコル使用時、CDR トラフィックは Blast の仮想チャネル経由で転送される。

#### CDR の ADMX テンプレートと詳細 GPO 設定

**ADMX テンプレート**: `hzn_agent_cdr.admx`（`vdm_agent.admx` とは別ファイル）

**設定パス**: `Computer Configuration` → `Administrative Templates` → `View Agent Configuration` → `Horizon Client Drive Redirection`

| GPO 設定項目 | 説明 |
|---|---|
| **Display redirected device with drive letter** | リダイレクトされたドライブにドライブレターを表示（デフォルト有効） |
| **Timeout for drive letter configuration** | ドライブレター表示の待機時間（デフォルト: 5000 ms） |
| **Configure drive letter mapping mode** | `One to one mapping`（クライアントと同じレター）/ `Defined mapping`（マッピングテーブルで指定） |
| **Define drive letter mapping table** | クライアント側 → エージェント側のドライブレターマッピングを定義 |

**UAG 経由での CDR**:
- **Blast Extreme**: CDR トラフィックは仮想チャネル経由で転送。追加ポート不要
- **PCoIP**: CDR 使用には UAG で **Horizon Tunnel を有効化** が必要（`Enable Tunnel` = Yes）

#### レジストリでの CDR 詳細設定

**レジストリパス**: `HKLM\SOFTWARE\Omnissa\Horizon\TSDR`

| キー | 型 | 説明 |
|---|---|---|
| `disabled` | REG_SZ | CDR を無効化（`true` = 無効、デフォルト: `false`） |
| `permissions` | REG_SZ | `r`（読み取り専用）/ `w`（書き込み専用）/ `rw`（読み書き、デフォルト） |
| `ForcedByAdmin` | REG_SZ | `true` でクライアントの追加フォルダ共有を禁止（共有ダイアログ非表示） |
| `default shares\<key>\name` | REG_SZ | 特定フォルダのみ共有（例: `C:\ebooks`）。`*all` で全ドライブ共有 |

**GPO 代替レジストリ**: `HKLM\SOFTWARE\Policies\Omnissa\Horizon\Agent\Configuration`

| キー | 型 | 説明 |
|---|---|---|
| `DisableDnDForCdr` | REG_DWORD | CDR でのドラッグ＆ドロップを無効化（1 = 無効） |

> **試験ポイント**: `ForcedByAdmin=true` はセキュリティ機能ではない。ユーザーは既存共有へのリンクを作成してバイパス可能。

#### Storage Drive Redirection（SDR）

SDR は CDR の代替として、より高い I/O パフォーマンスを提供するリダイレクション方式。

| 項目 | CDR | SDR |
|---|---|---|
| **I/O パフォーマンス** | 標準 | 高速 |
| **ドライブアクセス** | クライアントとリモート双方からアクセス可 | リダイレクト中はリモートのみ（排他的） |
| **プロトコル** | Blast / PCoIP | Blast / PCoIP |
| **デフォルト** | Agent / Client 双方にインストール済み | Agent / Client 双方にインストール済み |

**SDR の読み取り専用設定**: `HKLM\SOFTWARE\Omnissa\Horizon\SDR\ReadOnly` = `True`

---

## DEM / GPO を使用したポリシー設定

### DEM Smart Policy による設定

DEM（Dynamic Environment Manager）の Smart Policy は **条件ベース** でポリシーを動的に適用する仕組み。

**前提条件**:
- Horizon Agent に DEM FlexEngine がインストールされていること
- DEM Management Console で Horizon Smart Policy が有効化されていること

**Smart Policy で制御可能な Horizon 設定**:

| Smart Policy 項目 | 説明 |
|---|---|
| **Clipboard Redirection** | Clipboard リダイレクションの許可/拒否 |
| **Client Drive Redirection** | CDR の許可/拒否 |
| **USB Redirection** | USB リダイレクションの許可/拒否 |
| **Printing** | 印刷リダイレクションの制御 |
| **Bandwidth Profile** | 帯域幅プロファイルの適用 |

**Smart Policy の条件（Conditions）**:

| 条件タイプ | 例 |
|---|---|
| **IP Range** | クライアント IP アドレス範囲 |
| **Computer Name** | クライアントコンピュータ名 |
| **User / Group** | ユーザーまたは AD グループ |
| **Gateway Location** | 接続が内部/外部（UAG 経由）かの判定 |
| **Display Protocol** | Blast / PCoIP |

**Gateway Location の設定**:

Smart Policy で内部/外部アクセスを区別するには、Connection Server に Gateway Location を設定する必要がある。

1. Horizon Console → **Settings** → **Servers** → **Connection Servers** タブ
2. CS を選択 → **Edit** → **General** タブ
3. **Direct connection to desktop** のチェック状態:
   - チェックオン = **Internal**（内部接続）
   - チェックオフ = **External**（UAG 経由の外部接続）

**DEM Smart Policy の作成手順**:

1. DEM Management Console を開く
2. **Horizon Smart Policies** を選択
3. **Create** → ポリシー名を入力
4. **Conditions** タブで適用条件を設定（例: Gateway Location = External）
5. **Settings** タブで Horizon 設定を構成（例: USB Redirection = Deny）
6. ポリシーを保存 → 適用

### GPO による設定

**ADMX テンプレートの配置**:

1. Omnissa Customer Connect から **Horizon GPO Bundle** をダウンロード
2. `vdm_agent.admx` を `C:\Windows\PolicyDefinitions\` にコピー
3. 言語ファイル（`.adml`）を対応するサブフォルダにコピー
4. Group Policy Management Editor で設定が表示されることを確認

**GPO vs DEM の比較**:

| 項目 | GPO | DEM Smart Policy |
|---|---|---|
| **適用タイミング** | マシン起動 / ユーザーログオン時 | セッション開始時（リアルタイム） |
| **適用粒度** | OU / コンピュータ / ユーザー | 条件ベース（IP, Gateway, User, Protocol 等） |
| **条件分岐** | WMI フィルタで可能（複雑） | GUI で直感的に設定可能 |
| **動的変更** | gpupdate / 再ログオンが必要 | 次回セッション開始時に自動適用 |
| **内部/外部の区別** | 別 OU / WMI フィルタが必要 | Gateway Location 条件で簡単に区別 |
| **推奨ユースケース** | 全マシン共通のベースラインポリシー | 条件に応じた動的なポリシー制御 |

> **試験ポイント**: 「外部接続時のみ Clipboard を無効にしたい」場合、DEM Smart Policy で **Gateway Location = External** の条件を使うのが最も効率的。GPO だけでは接続元の内部/外部判定が困難。

---

## USB Redirection ポリシーの設定

### USB Redirection の概要

USB Redirection はクライアントに接続された USB デバイスをリモートデスクトップ/アプリケーションで使用する機能。セキュリティリスク（BadUSB 等）があるため、適切なフィルタリングが重要。

**前提条件**:
- Horizon Agent インストール時に **USB Redirection** コンポーネントを選択（デフォルトでは非選択）
- Horizon Client 側でも USB Redirection コンポーネントが必要（デフォルトで選択済み）
- Horizon Console → **Policies** → **Global Policies** で **USB access** が **Allow** であること

### USB フィルタリングの設定

**ADMX テンプレート**: `vdm_agent.admx`

**設定パス**: `Computer Configuration` → `Policies` → `Administrative Templates` → `Omnissa Horizon Agent Configuration` → `View USB Configuration`

**レジストリパス**: `HKLM\SOFTWARE\Policies\Omnissa\Horizon\Agent\USB`

#### Exclude / Include ルール

| ルール | 書式 | 説明 |
|---|---|---|
| **ExcludeAllDevices** | `true` / `false` | すべての USB デバイスを除外/許可 |
| **ExcludeDeviceFamily** | `o:video;audio;storage` | デバイスファミリ単位で除外 |
| **ExcludeVidPid** | `o:vid-0781_pid-****` | VID/PID 指定でデバイスを除外 |
| **ExcludeVidPidRel** | `o:vid-0781_pid-5591_rel-0100` | VID/PID/Release 指定で除外 |
| **IncludeDeviceFamily** | `o:storage` | デバイスファミリ単位で許可 |
| **IncludeVidPid** | `o:vid-0781_pid-554c` | VID/PID 指定でデバイスを許可 |

**修飾子（Modifier）**:

| 修飾子 | 意味 | 動作 |
|---|---|---|
| `o:` (override) | 上書き | Agent 側の設定で Client 側の設定を上書き |
| `m:` (merge) | マージ | Agent 側の設定を Client 側の設定に追加 |

> **試験ポイント**: Agent 側の設定に `o:` や `m:` 修飾子がない場合、そのルールは **無効** として無視される。

#### フィルタルールの優先順位

**Horizon Client 側の評価順序**（1 が最高優先）:

1. Exclude Path
2. Include Path
3. **Exclude Vid/Pid Device**
4. **Include Vid/Pid Device**
5. **Exclude Device Family**
6. **Include Device Family**
7. Allow 系設定（Audio, HID, Smart Card, Video 等）
8. Exclude All Devices

**Horizon Agent 側の評価順序**（1 が最高優先）:

1. Include Vid/Pid Device
2. Include Device Family
3. Exclude Vid/Pid Device
4. Exclude Device Family
5. Exclude All Devices

> **試験ポイント**: Client 側と Agent 側でフィルタの **優先順位が逆** になっている点に注意。Client 側では Exclude が優先、Agent 側では Include が優先。

### USB Device Family 一覧

フィルタルールで使用できる主要なデバイスファミリ:

| ファミリ名 | 説明 | セキュリティ上の考慮 |
|---|---|---|
| `audio` | オーディオ入出力デバイス | RTAV 機能で代替推奨 |
| `audio-in` | マイク等の入力デバイス | RTAV 機能で代替推奨 |
| `audio-out` | スピーカー等の出力デバイス | RTAV 機能で代替推奨 |
| `hid` | HID（キーボード・マウス除く） | BadUSB リスクあり |
| `imaging` | スキャナ等 | Scanner Redirection で代替推奨 |
| `keyboard` | キーボード | デフォルトでブロック |
| `mouse` | ポインティングデバイス | デフォルトでブロック |
| `printer` | プリンタ | Integrated Printing で代替推奨 |
| `security` | 指紋リーダー等 | 許可する場合は VID/PID で限定 |
| `smart-card` | スマートカードリーダー | Smart Card Redirection で代替推奨 |
| `storage` | USBフラッシュドライブ、外部HDD | CDR で代替推奨。最もリスクの高いカテゴリ |
| `video` | Web カメラ等 | RTAV 機能で代替推奨 |

### Composite USB Device の分割（Splitting）

複合デバイス（例: マイク + ストレージが一体化した USB デバイス）は、インターフェースごとに分割してリダイレクトを制御可能。

**自動分割**:
- `Allow Auto Device Splitting` = **Allow - Override Client Setting**
- デフォルトでは無効。有効時、Audio / Keyboard / Mouse / Smart Card コンポーネントはリダイレクション対象外

**手動分割**:
- `Split Vid/Pid Device` = `vid-0781_pid-554c(exintf:00;exintf:01)`
- 特定インターフェース番号を除外してリダイレクト

**フィルタリングの設定例**:

```
# 全デバイスをブロックし、特定デバイスのみ許可
ExcludeAllDevices: true
IncludeVidPid: o:vid-0123_pid-abcd;vid-1abc_pid-0001

# ストレージデバイスのみブロック（Agent 側）
ExcludeDeviceFamily: o:storage

# 特定ベンダーの全デバイスをブロック
ExcludeVidPid: o:vid-0341_pid-*
```

### USB Redirection のセキュリティリスクと軽減策

| リスク | 説明 | 軽減策 |
|---|---|---|
| **BadUSB** | USB デバイスのファームウェアがハイジャックされ、キーボードエミュレーションやネットワークリダイレクトが行われる | `ExcludeAllDevices=true` + 必要デバイスのみ `IncludeVidPid` で許可 |
| **データ漏洩** | USB ストレージへの機密データコピー | `storage` ファミリを除外、CDR/SDR で代替 |
| **マルウェア感染** | USB 経由のマルウェア持ち込み | サプライチェーンの信頼性確認、FIPS 140-2 Level 3 認定ファームウェアのみ許可 |
| **外部アクセス経由の USB リスク** | 外部ネットワークからの USB アクセス | TCP 32111 のブロック（タイムゾーン同期にも影響する点に注意）、DEM Smart Policy で External 時に USB Deny |

> **試験ポイント**: ゼロクライアントの場合、USB トラフィックは UDP 4172（PCoIP 仮想チャネル内）に組み込まれるため、ポート 4172 をブロックすると表示プロトコル自体が使用不能になる。

### Agent-side vs Connection Server-side の設定の違い

| 項目 | Agent-side（GPO / レジストリ） | CS-side（Horizon Console） |
|---|---|---|
| **設定粒度** | デバイスタイプ / VID・PID / ファミリ単位 | Allow / Deny の 2 択 |
| **方向制御** | Clipboard の方向（C→S / S→C / 双方向）を制御可能 | 不可 |
| **USB フィルタ** | Include / Exclude / Split の詳細ルール | USB access の Allow / Deny のみ |
| **CDR 制御** | 読み取り専用、ドライブレター制御等 | Allow / Deny の 2 択 |
| **ユーザー上書き** | 不可（GPO が強制） | Pool / User Override で設定可能 |
| **適用方法** | ADMX テンプレートを AD GPO にリンク | Console で設定 |

---

## その他のデータ保護機能

### デジタルウォーターマーク

リモートセッション上にトレーサブルな透かし情報を表示し、知的財産の保護とデータ漏洩の抑止を図る機能。

**対応範囲**:
- 公開アプリケーション、仮想デスクトップ、RDS ホスト、ネストモード、マルチモニター
- スクリーンキャプチャや PrintScreen キーで取得した画像にもウォーターマークが含まれる

**制限事項**: RDP 非対応、HTML5 MMR 非対応、Zoom/Webex 録画にはウォーターマーク非反映

**GPO 設定**: `vdm_agent.admx` → `View Agent Configuration` → ウォーターマーク関連設定
- テキスト内容、レイアウト、回転角度、不透明度を構成可能
- 変更はユーザーの次回ログイン時に反映

### スクリーンキャプチャ制御

**Screen Capture Blocking**: 環境変数を使用してリモートデスクトップのスクリーンキャプチャを制限可能。

**Screen Capture 機能**（2506 以降強化）:
- GPO で有効化するとタイトルバーに PrintScreen アイコンが表示
- キャプチャ画像はリモートデスクトップの Pictures フォルダに `.png` として保存
- マルチモニター環境ではキャプチャ対象画面の選択が可能

> **試験ポイント**: Screen Capture Blocking 設定と Screen Capture 機能は **独立して動作** する。Blocking を設定しても管理者が有効化した Screen Capture 機能は動作する。

### ドラッグ＆ドロップ制御

**ADMX テンプレート**: `vdm_agent_dnd.admx` → `View Agent Configuration` → `Drag and Drop`

| GPO 設定項目 | 説明 |
|---|---|
| **Configure drag and drop direction** | ドラッグ＆ドロップの方向制御（C→S / S→C / 双方向 / 無効） |
| **Configure drag and drop formats** | 許可するデータ形式の制御 |
| **Configure drag and drop size limit** | 転送サイズの上限設定 |

**前提条件**: ファイル/フォルダのドラッグ＆ドロップには **Client Drive Redirection** の有効化が必要。

DEM Smart Policy でも Drag and Drop の有効/無効を動的に制御可能（DEM 9.8 以降）。

### FIDO2 / WebAuthn リダイレクション

WebAuthn リダイレクションにより、FIDO2 デバイス全体を転送せずにリモートセッションで FIDO2 認証を利用可能。

| クライアント | VDI デスクトップ | RDS ホスト |
|---|---|---|
| **Windows / macOS / Linux** | WebAuthn リダイレクション対応 | FIDO2 リダイレクション対応 |
| **iOS** | 非対応 | 非対応 |
| **Android / Web** | USB リダイレクション経由 | USB リダイレクション経由（Chrome のみ） |

**GPO 設定**: `vdm_agent.admx` → `View Agent Configuration` の FIDO2 関連設定

> **試験ポイント**: WebAuthn リダイレクションは UWP ベースの Windows アプリ（Teams, Outlook for 365, OneDrive）では動作しない場合がある。ワークアラウンドとして VDI デスクトップでは USB リダイレクションを使用。

### キーロガーブロック（Keylogger Blocking）

**Horizon 2412 新機能**: Agent 側でキーロガーブロックポリシーを有効にすると、Client が自動的にエンドユーザーにブロック有効化のプロンプトを表示する **Automated Keylogger Protection** が導入。

- GPO 設定で Agent 側のポリシーを構成
- Horizon Client for Windows で利用可能
- キーストロークの傍受を防止し、認証情報やセンシティブデータの保護を強化

---

## ベストプラクティス

- **Defense in Depth**: CS Global Policy でベースラインを設定 → Agent GPO でデバイスタイプ別の制御 → DEM Smart Policy で条件ベースの動的制御を組み合わせる
- **USB ストレージは CDR/SDR で代替**: USB Redirection でのストレージ転送はパフォーマンスが低く、セキュリティリスクも高い。CDR または SDR を使用する（SDR はさらに高速）
- **Clipboard は最小権限で設定**: 必要最小限の方向・データ形式のみ許可。ファイルコピーが不要な環境では `FileContents` / `FileGroupDescriptor` を無効化
- **外部接続時の制限強化**: DEM Smart Policy の Gateway Location 条件を活用し、UAG 経由のアクセス時は USB / Clipboard / CDR を制限
- **Clipboard 監査を有効化**: コンプライアンス要件がある環境では Agent GPO の `Configure clipboard audit` を有効にする
- **USB フィルタは Agent 側で必ず `o:` または `m:` 修飾子を付与**: 修飾子なしのルールは無視される
- **デジタルウォーターマークの活用**: 機密情報を扱う環境ではウォーターマークを有効化し、スクリーンショットからの情報漏洩を抑止する
- **ドラッグ＆ドロップの方向制御**: Clipboard と同様に、ドラッグ＆ドロップも方向を制限する（特に S→C 方向）
- **UAG の BSG Feature List**: 必要な機能のみホワイトリスト登録し、不要な機能（USB Redirection 等）をブロックする
- **キーロガーブロックの有効化**: 特にキオスク端末やシンクライアント環境では Automated Keylogger Protection を有効化する

## アンチパターン

| やってはいけないこと | 理由 |
|---|---|
| CS Global Policy だけで USB を Deny にして Agent GPO を未設定 | Agent GPO で Allow になっている場合、CS 設定が上書きされる可能性 |
| 全 USB デバイスを許可（ExcludeAllDevices = false）のまま運用 | BadUSB 等のセキュリティリスクにさらされる |
| CDR と USB Storage Redirection を同時に有効化 | 競合やパフォーマンス問題の原因 |
| USB フィルタルールに修飾子（`o:` / `m:`）を付けずに設定 | ルールが無効として無視される |
| DEM Smart Policy で Gateway Location を設定せずに内部/外部の区別を試みる | CS に Direct Connection 設定がないと Gateway Location 条件が正しく動作しない |
| Clipboard を双方向で許可しつつ監査を無効にする | データ漏洩が発生しても追跡不可能 |
| `ForcedByAdmin=true` をセキュリティ制御として依存する | ユーザーが既存共有へのリンクを作成してバイパス可能 |
| PCoIP 使用時に UAG で Horizon Tunnel を有効化せず CDR を使用 | CDR が動作しない（Blast では Tunnel なしでも動作） |
| ドラッグ＆ドロップを制限せずに Clipboard のみ制限する | ドラッグ＆ドロップ経由でデータ漏洩が可能 |

---

## 理解度チェックリスト

### Clipboard ポリシー

- [ ] Clipboard 制御の 3 レベル（Agent GPO / DEM Smart Policy / CS Global Policy）とその優先順位を説明できる
- [ ] Agent GPO での Clipboard 方向制御（C→S, S→C, 双方向, 無効）の設定方法を理解している
- [ ] Clipboard 形式フィルタリング（Text, RTF, Image, HTML, File）の設定方法を説明できる
- [ ] Clipboard 監査の有効化手順を理解している

### CDR（Client Drive Redirection）

- [ ] CDR の設定場所（Horizon Console, Agent GPO, レジストリ）を説明できる
- [ ] CDR の読み取り専用設定の方法を理解している
- [ ] CDR とUSB Storage Redirection の違いと推奨される使い分けを説明できる

### USB Redirection

- [ ] USB フィルタリングの Exclude / Include ルール書式（VID/PID, Family, Split）を理解している
- [ ] フィルタルールの修飾子（`o:` / `m:`）の意味と必要性を説明できる
- [ ] Client 側と Agent 側のフィルタ優先順位の違いを理解している
- [ ] Composite USB Device の分割（Splitting）の概念と設定方法を説明できる
- [ ] USB Device Family 名（storage, video, audio, hid 等）を把握している

### ポリシー設定方法

- [ ] DEM Smart Policy の条件（Gateway Location, IP Range, User/Group）と設定手順を説明できる
- [ ] GPO による ADMX テンプレートの配置と設定手順を理解している
- [ ] GPO と DEM Smart Policy の違い（適用タイミング、粒度、条件分岐）を説明できる
- [ ] Agent-side と CS-side の設定の違いと使い分けを理解している

### その他のデータ保護

- [ ] デジタルウォーターマークの対応範囲と制限事項を説明できる
- [ ] スクリーンキャプチャ制御（Blocking と Screen Capture 機能の違い）を理解している
- [ ] ドラッグ＆ドロップの方向制御と ADMX テンプレート（`vdm_agent_dnd.admx`）を理解している
- [ ] FIDO2 / WebAuthn リダイレクションの対応状況（クライアント/プラットフォーム別）を説明できる
- [ ] SDR と CDR の違い（パフォーマンス、排他アクセス）を説明できる
- [ ] CDR のレジストリ設定（`permissions`, `ForcedByAdmin`, `default shares`）を理解している
- [ ] キーロガーブロック（Automated Keylogger Protection）の概要を説明できる
- [ ] UAG の BSG Feature List による機能制御の仕組みを理解している
