# 1.5 Licenses and Edge Gateway

## 概要

Horizon環境のライセンス管理とEdge Gatewayのデプロイは、環境の運用と分析に重要です。OCE-Hレベルでは、ライセンス方法の評価とEdge Gatewayのデプロイが求められます。

## 学習目標

このセクションを学習することで、以下のことができるようになります：

- 期間ライセンス（Term License）とサブスクリプションライセンス（Subscription License）の違いを説明できる
- ライセンス方法の選択基準を理解している
- Edge GatewayをデプロイしてSubscription接続を設定できる
- Edge Gatewayの前提条件と設定手順を理解している

## 関連リソース

- [クイックリファレンス](../../00_Quick_Reference.md) - ポート番号、設定値、制限値
- [用語集](../../README.md#用語集) - 関連用語の定義
- [7.3 Omnissa Intelligence Integration](../../Section7_Automation_Integration/7.3_Omnissa_Intelligence_Integration.md) - Omnissa Intelligence統合
- [実環境シナリオ](../../00_Scenarios/Section1_Scenarios.md) - 実環境でのシナリオ例

## ライセンス方法の評価

### 期間ライセンス（Term License）

**概要**:
- 固定期間（例：1年、3年）のライセンス
- 期間終了後に更新が必要

**利点**:
- 予測可能なコスト
- 長期的な計画が可能
- 一括購入による割引

**欠点**:
- 初期コストが高い
- 柔軟性が低い

### サブスクリプションライセンス

**概要**:
- 月次または年次のサブスクリプション
- 継続的な支払い

**利点**:
- 柔軟性が高い
- 初期コストが低い
- 最新機能へのアクセス

**欠点**:
- 長期的なコストが高い可能性
- 継続的な管理が必要

### ライセンス方法の選択ガイド

| 要件 | 推奨方法 |
|------|---------|
| 長期的な計画 | 期間ライセンス |
| 柔軟性重視 | サブスクリプション |
| 予算制約 | サブスクリプション |
| 大規模環境 | 期間ライセンス |

> [!IMPORTANT]

> ライセンス方法の選択は、組織の予算、計画、要件に基づいて決定する必要があります。

## Horizon Edge Gatewayのデプロイ

### Edge Gatewayの概要

**機能**:
- Omnissa Intelligenceへのデータ送信
- Horizon環境のメトリック収集
- カスタムレポートの生成

**要件**:
- Horizon環境への接続
- Omnissa Intelligenceサブスクリプション
- ネットワーク接続（インターネット）

### Edge Gatewayのダウンロード

**ダウンロード手順**:

1. **Omnissa Customer Connectにアクセス**
   - https://customerconnect.omnissa.com

2. **Horizon Edge Gatewayのダウンロード**
   - Products → Horizon → Downloads
   - Edge Gatewayを選択
   - 最新バージョンをダウンロード

3. **インストールファイルの確認**
   - OVAファイル（vSphere環境）
   - ISOファイル（物理環境）

### Edge Gatewayのデプロイ

#### vSphere環境でのデプロイ

**OVAファイルからのデプロイ**:

1. **vSphere ClientでOVAをインポート**
   - File → Deploy OVF Template
   - OVAファイルを選択

2. **デプロイ設定**
   - 名前: `horizon-edge-gateway`
   - データストア: 適切なデータストアを選択
   - ネットワーク: 管理ネットワークを選択

3. **初期設定**
   - IPアドレスの設定
   - デフォルトゲートウェイの設定
   - DNS設定

#### サブスクリプションとの接続性

**接続設定**:

1. **Edge Gateway管理コンソールにアクセス**
   - `https://<Edge Gateway IP>`

2. **Omnissa Intelligenceへの接続設定**
   - Subscription URL: `https://connect.omnissa.com`
   - 認証情報の入力
   - 接続テスト

3. **Horizon環境の登録**
   - Connection ServerのFQDNまたはIPアドレス
   - 認証情報
   - 接続テスト

> [!TIP]

> Edge Gatewayのデプロイ後、Omnissa Intelligenceへの接続を確認し、データ送信が正常に行われていることを確認してください。

### Edge Gatewayの設定

#### ネットワーク設定

**必要なポート**:
- **443 (HTTPS)**: Omnissa Intelligenceへの接続（送信）

**ファイアウォールルール**:
```powershell
# Edge GatewayからOmnissa Intelligenceへの接続を許可
New-NetFirewallRule -DisplayName "Edge Gateway to Intelligence" `
    -Direction Outbound -RemotePort 443 -Protocol TCP -Action Allow `
    -RemoteAddress "connect.omnissa.com"
```

#### 認証設定

**認証方法**:
- APIキー
- OAuth 2.0
- 証明書ベース認証

**設定手順**:
1. Omnissa IntelligenceでAPIキーを生成
2. Edge GatewayでAPIキーを設定
3. 接続テスト

## ベストプラクティス

1. **ライセンス管理**
   - ライセンス使用状況の定期的な監視
   - ライセンス期限の管理
   - ライセンスの最適化

2. **Edge Gateway**
   - 定期的な更新
   - セキュリティ設定の確認
   - データ送信の監視

> [!CAUTION]

> Edge Gatewayは、Omnissa Intelligenceへのデータ送信にインターネット接続が必要です。ファイアウォールルールを適切に設定してください。

## まとめ

ライセンス方法の適切な評価とEdge Gatewayのデプロイは、Horizon環境の運用と分析に重要です。組織の要件に基づいて適切なライセンス方法を選択し、Edge Gatewayを適切にデプロイすることで、効率的なHorizon環境を構築できます。
